<!DOCTYPE html>
<html>
<head>
    <title>Device: {{ device.DeviceName }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>{{ device.DeviceName }} ({{ device.DeviceID }})</h1>

    {% if message %}
        <p class="message">{{ message }}</p>
    {% endif %}

    <h2>Owner Details</h2>
    <ul>
        <li><strong>Name:</strong> {{ device.Owner }}</li>
        <li><strong>PS Number:</strong> {{ device.OwnerPS }}</li>
        <li><strong>Phone:</strong> {{ device.OwnerPhone }}</li>
        <li><strong>Email:</strong> {{ device.OwnerEmail }}</li>
    </ul>

    <h2>Current User</h2>
    <ul>
        <li><strong>Name:</strong> {{ device.CurrentUser }}</li>
        <li><strong>PS Number:</strong> {{ device.CurrentPS }}</li>
        <li><strong>Phone:</strong> {{ device.CurrentPhone }}</li>
        <li><strong>Email:</strong> {{ device.CurrentEmail }}</li>
    </ul>

    <h2>New User</h2>
    <form method="POST">
        <label>Name: <input type="text" name="user" required></label><br>
        <label>PS Number: <input type="text" name="ps" pattern="\\d+" required></label><br>
        <label>Phone: <input type="text" name="phone" pattern="\\d+" required></label><br>
        <label>Email: <input type="email" name="email" required></label><br>
        <button type="submit">Update New User</button>
    </form>

    <form method="POST">
        <input type="hidden" name="reset" value="1">
        <button type="submit">Reset to Owner</button>
    </form>

    {% if history %}
    <h2>Last 10 Ownership Transfers</h2>
    <table>
        <thead>
            <tr>
                <th>Time</th>
                <th>Old User</th>
                <th>Old PS</th>
                <th>New User</th>
                <th>New PS</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in history %}
            <tr>
                <td>{{ entry.Timestamp }}</td>
                <td>{{ entry.OldUser }}</td>
                <td>{{ entry.OldPS }}</td>
                <td>{{ entry.NewUser }}</td>
                <td>{{ entry.NewPS }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</body>
</html>
