<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Device Details</title>
    <style>
        label { display: block; margin-top: 10px; }
        input { width: 300px; }
    </style>
</head>
<body>
    {% if device %}
        <h1>{{ device['DeviceName'] }} ({{ device['DeviceID'] }})</h1>

        <h2>Ownership Details (Fixed)</h2>
        <ul>
            <li><strong>Owner:</strong> {{ device['Owner'] }}</li>
            <li><strong>PS Number:</strong> {{ device['OwnerPS'] }}</li>
            <li><strong>Phone:</strong> {{ device['OwnerPhone'] }}</li>
            <li><strong>Email:</strong> {{ device['OwnerEmail'] }}</li>
        </ul>

        <h2>Current User</h2>
        <ul>
            <li><strong>User:</strong> {{ device['CurrentUser'] }}</li>
            <li><strong>PS Number:</strong> {{ device['CurrentPS'] }}</li>
            <li><strong>Phone:</strong> {{ device['CurrentPhone'] }}</li>
            <li><strong>Email:</strong> {{ device['CurrentEmail'] }}</li>
            <li><strong>Last Updated:</strong> {{ device['LastUpdated'] }}</li>
        </ul>

        <h3>New User (All Fields Required)</h3>
        <form method="post">
            <label>New User Name:
                <input type="text" name="user" required>
            </label>
            <label>PS Number:
                <input type="number" name="ps" required>
            </label>
            <label>Phone:
                <input type="number" name="phone" required>
            </label>
            <label>Email:
                <input type="email" name="email" required>
            </label>
            <button type="submit" name="action" value="transfer">‚úÖ Update New User</button>
            <button type="submit" name="action" value="reset">üîÅ Reset to Owner</button>
        </form>

        <h3>Last 10 Transfers</h3>
        {% if history %}
            <table border="1">
                <tr>
                    <th>Previous PS</th>
                    <th>New PS</th>
                    <th>Timestamp</th>
                </tr>
                {% for row in history %}
                    <tr>
                        <td>{{ row['PreviousPS'] }}</td>
                        <td>{{ row['NewPS'] }}</td>
                        <td>{{ row['Timestamp'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>No transfer history yet.</p>
        {% endif %}

        {% if message %}
            <p><strong>{{ message }}</strong></p>
        {% endif %}

    {% else %}
        <h1>Device Not Found</h1>
    {% endif %}

    <p><a href="/">‚¨Ö Back to Device List</a></p>
</body>
</html>